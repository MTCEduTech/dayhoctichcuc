<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <script src="auth.js"></script>
  <title>B·ªô So·∫°n ƒê·ªÅ Tr·∫Øc Nghi·ªám</title>
  <style>
    body { font-family: sans-serif; padding: 10px; }
    textarea { width: 80%; height: 50px; margin-bottom: 10px; }
    button { padding: 10px 20px; margin-top: 10px; }
    .question-block { border: 1px solid #ccc; padding: 10px; margin-bottom: 20px; border-radius: 10px; }

    /* C·ªë ƒë·ªãnh c√°c n√∫t ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
    .fixed-buttons {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    /* ƒêi·ªÅu ch·ªânh style cho c√°c n√∫t */
    .fixed-buttons button {
      width: 220px;
      padding: 10px 15px;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }

    .fixed-buttons .add-question-btn {
      background-color: #4caf50;
      color: white;
    }

    .fixed-buttons .export-btn {
      background-color: #2196f3;
      color: white;
    }

    .fixed-buttons .home-btn {
      background-color: red;
      color: white;
      font-weight: bold;
    }

.title {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background-color: pink;
  text-align: center;
  color: blue;
  font-weight: bold;
  padding: 15px 0;
  margin: 0;
  z-index: 1000;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}


  </style>
</head>
<body>

<h2 class="title">B·ªô So·∫°n ƒë·ªÅ tr·∫Øc nghi·ªám cho tr√≤ ch∆°i "Ai l√† tri·ªáu ph√∫"</h2>
<div style="height: 70px;"></div>

<div id="questions-container">
  <!-- C√°c kh·ªëi c√¢u h·ªèi s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
</div>

<div class="fixed-buttons">
  <!-- N√∫t Th√™m c√¢u h·ªèi -->
  <button class="add-question-btn" onclick="addQuestion()">‚ûï Th√™m c√¢u h·ªèi</button>
  
  <!-- N√∫t Xu·∫•t HTML -->
  <button class="export-btn" onclick="exportHTML()">üíæ Xu·∫•t HTML</button>
  <button onclick="saveDraft()">üìã L∆∞u t·∫°m th·ªùi d·ªØ li·ªáu</button>
<button onclick="resetForm()">üìùT·∫°o m·ªõi ho√†n to√†n</button>
<input type="file" id="upload-html-file" accept=".html" style="display: none;" onchange="importFromHTML(event)">
<button onclick="document.getElementById('upload-html-file').click()">üìÇ T·∫£i v√†o l·∫°i ƒë·ªÅ ƒë√£ xu·∫•t</button>
  <!-- N√∫t V·ªÅ trang ch·ªß -->
  <button class="home-btn" onclick="window.location.href='index.html'"> üè† V·ªÄ TRANG CH·ª¶</button>
</div>

<script>
let questionCount = 0;

function addQuestion() {
  questionCount++;
  const container = document.getElementById("questions-container");
  const block = document.createElement("div");
  block.className = "question-block";
  block.innerHTML = `
    <h3>C√¢u h·ªèi ${questionCount}</h3>
    <textarea placeholder="C√¢u h·ªèi"></textarea><br>
    <textarea placeholder="ƒê√°p √°n ƒë√∫ng"></textarea><br>
    <textarea placeholder="ƒê√°p √°n sai 1"></textarea><br>
    <textarea placeholder="ƒê√°p √°n sai 2"></textarea><br>
    <textarea placeholder="ƒê√°p √°n sai 3"></textarea><br>
    <textarea placeholder="G·ª£i √Ω"></textarea><br>
  `;
  container.appendChild(block);
}

function exportHTML() {
  const blocks = document.querySelectorAll(".question-block");
  let content = '';
  content += '<!DOCTYPE html>\n';
  content += '<html lang="vi">\n';
  content += '<head>\n';
  content += '  <meta charset="UTF-8">\n';
  content += '  <title>ƒê·ªÅ Ai l√† tri·ªáu ph√∫</title>\n';
  content += '</head>\n';
  content += '<body>\n';
  content += '<h2>Ng√¢n h√†ng c√¢u h·ªèi</h2>\n';

  blocks.forEach(block => {
    const fields = block.querySelectorAll("textarea");
    const question = fields[0].value.trim();
    const correct = fields[1].value.trim();
    const wrong1 = fields[2].value.trim();
    const wrong2 = fields[3].value.trim();
    const wrong3 = fields[4].value.trim();
    const hint = fields[5].value.trim();

    if (question && correct && wrong1 && wrong2 && wrong3) {
      content += '<p>\n';
      content += 'C√¢u h·ªèi: ' + question + '<br>\n';
      content += 'ƒê√°p √°n ƒë√∫ng: ' + correct + '<br>\n';
      content += 'ƒê√°p √°n sai: ' + wrong1 + '<br>\n';
      content += 'ƒê√°p √°n sai: ' + wrong2 + '<br>\n';
      content += 'ƒê√°p √°n sai: ' + wrong3 + '<br>\n';
      content += 'G·ª£i √Ω: ' + hint + '\n';
      content += '</p>\n';
    }
  });

  content += '</body>\n</html>';

  const blob = new Blob([content], { type: "text/html" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "de_Ai_la_trieu_phu.html";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

function saveDraft() {
  const blocks = document.querySelectorAll(".question-block");
  const draft = [];

  blocks.forEach(block => {
    const fields = block.querySelectorAll("textarea");
    draft.push({
      question: fields[0].value,
      correct: fields[1].value,
      wrong1: fields[2].value,
      wrong2: fields[3].value,
      wrong3: fields[4].value,
      hint: fields[5].value
    });
  });

  localStorage.setItem("draft_questions", JSON.stringify(draft));
  alert("‚úÖ B·∫°n ƒëang t·∫°m ngh·ªâ khi so·∫°n c√¢u h·ªèi cho tr√≤ ch∆°i Ai L√† Tri·ªáu Ph√∫. H·ªá th·ªëng ƒë√£ l∆∞u t·∫°m th·ªùi d·ªØ li·ªáu!");
}


function resetForm() {
  if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô d·ªØ li·ªáu v√† b·∫Øt ƒë·∫ßu l·∫°i?")) {
    localStorage.removeItem("draft_questions"); // Xo√° b·∫£n l∆∞u t·∫°m
    location.reload(); // T·∫£i l·∫°i trang
  }
}


function importFromHTML(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    const content = e.target.result;

    // T·∫°o m·ªôt DOM t·∫°m ƒë·ªÉ ph√¢n t√≠ch n·ªôi dung
    const parser = new DOMParser();
    const doc = parser.parseFromString(content, "text/html");
    const paragraphs = doc.querySelectorAll("p");

    // Xo√° to√†n b·ªô c√¢u h·ªèi hi·ªán t·∫°i
    document.getElementById("questions-container").innerHTML = "";
    questionCount = 0;

    paragraphs.forEach(p => {
      const text = p.innerHTML;

      // Tr√≠ch xu·∫•t t·ª´ng ph·∫ßn
      const question = (text.match(/C√¢u h·ªèi: (.*?)<br>/) || [])[1] || "";
      const correct = (text.match(/ƒê√°p √°n ƒë√∫ng: (.*?)<br>/) || [])[1] || "";
      const wrongs = [...text.matchAll(/ƒê√°p √°n sai: (.*?)<br>/g)].map(m => m[1]);
      const hintMatch = text.match(/G·ª£i √Ω: (.*)/);
      const hint = hintMatch ? hintMatch[1] : "";

      if (question && correct && wrongs.length === 3) {
        addQuestion();
        const block = document.querySelectorAll(".question-block");
        const fields = block[block.length - 1].querySelectorAll("textarea");
        fields[0].value = question;
        fields[1].value = correct;
        fields[2].value = wrongs[0];
        fields[3].value = wrongs[1];
        fields[4].value = wrongs[2];
        fields[5].value = hint;
      }
    });

    alert("‚úÖ ƒê√£ t·∫£i v√†o n·ªôi dung t·ª´ file HTML!");
  };

  reader.readAsText(file);
}

</script>
<div style="
  position: fixed;
  bottom: 20px;
  left: 20px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: flex-start;
">
  <button id="fullscreen-btn" onclick="toggleFullscreen()" style="
    background-color: #3498db;
    color: white;
    font-weight: bold;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    width: 220px;
    display: block;
transition: background-color 0.3s ease;
  ">
    üì± FULL M√ÄN H√åNH
  </button>
</div>
<script>
function toggleFullscreen() {
    const docElm = document.documentElement;

    // N·∫øu ƒëang fullscreen -> tho√°t
    if (document.fullscreenElement || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement) {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.mozCancelFullScreen) { // Firefox
            document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) { // Chrome, Safari, Opera
            document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) { // IE/Edge
            document.msExitFullscreen();
        }
    } else {
        // V√†o fullscreen
        if (docElm.requestFullscreen) {
            docElm.requestFullscreen();
        } else if (docElm.mozRequestFullScreen) { // Firefox
            docElm.mozRequestFullScreen();
        } else if (docElm.webkitRequestFullscreen) { // Chrome, Safari and Opera
            docElm.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
        } else if (docElm.msRequestFullscreen) { // IE/Edge
            docElm.msRequestFullscreen();
        }
    }
}

/* C·∫≠p nh·∫≠t nh√£n n√∫t khi tr·∫°ng th√°i fullscreen thay ƒë·ªïi (nh·∫•n ESC) */
function updateFullscreenButton() {
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    if (!fullscreenBtn) return;

    const isFullscreen = document.fullscreenElement || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement;

    if (isFullscreen) {
        fullscreenBtn.innerHTML = '‚ùå FULL M√ÄN H√åNH';
        fullscreenBtn.style.backgroundColor = '#e67e22'; // m√†u khi ƒëang fullscreen
    } else {
        fullscreenBtn.innerHTML = 'üì± FULL M√ÄN H√åNH';
        fullscreenBtn.style.backgroundColor = '#3498db'; // m√†u khi ch∆∞a fullscreen
    }
}

/* L·∫Øng nghe s·ª± ki·ªán thay ƒë·ªïi fullscreen (k√®m c√°c ti·ªÅn t·ªë cho tr√¨nh duy·ªát) */
document.addEventListener('fullscreenchange', updateFullscreenButton);
document.addEventListener('webkitfullscreenchange', updateFullscreenButton);
document.addEventListener('mozfullscreenchange', updateFullscreenButton);
document.addEventListener('MSFullscreenChange', updateFullscreenButton);

/* Kh·ªüi t·∫°o tr·∫°ng th√°i n√∫t (n·∫øu trang load m√† ƒëang fullscreen) */
document.addEventListener('DOMContentLoaded', updateFullscreenButton);
</script>
<script>
window.onload = function() {
  const savedDraft = localStorage.getItem("draft_questions");
  if (savedDraft) {
    const draft = JSON.parse(savedDraft);
    draft.forEach(data => {
      addQuestion();
      const block = document.querySelectorAll(".question-block");
      const fields = block[block.length - 1].querySelectorAll("textarea");
      fields[0].value = data.question || "";
      fields[1].value = data.correct || "";
      fields[2].value = data.wrong1 || "";
      fields[3].value = data.wrong2 || "";
      fields[4].value = data.wrong3 || "";
      fields[5].value = data.hint || "";
    });
  }
};

</script>

  <script src="chao_name.js"></script>
</body>
</html>
