<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
 <script src="auth.js"></script>
  <title>Tr√≤ Ch∆°i √î Ch·ªØ B√≠ M·∫≠t</title>
  <style>
  :root {
    --dich-phai: 600px;
  }

  body {
    font-family: Arial, sans-serif;
    background: url("Nen.jpg") no-repeat center center fixed;
    background-size: cover;
    margin: 0;
    padding: 0;
    padding-top: 80px;
    color: #fff;
    text-align: center;
  }

  header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    background-color: #fff8dc;
    border-bottom: 2px solid #ccc;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    height: 80px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 5px 10px;
    z-index: 1000;
  }

  .main-title {
    color: red;
    font-weight: bold;
    font-size: 18px;
    line-height: 1.2;
    margin: 1px 0;
    padding: 1px 0;
  }

  .container {
    display: flex;
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    gap: 20px;
  }

  .left-panel {
    width: 25%;
  }

  .right-panel {
    width: 25%;
    border-left: 1px solid #999;
    padding-left: 10px;
  }

  .main-controls {
  display: flex;
  justify-content: center;
  align-items: center;   /* Th√™m d√≤ng n√†y ƒë·ªÉ n√∫t cao th·∫•p s·∫Ω canh theo gi·ªØa */
  gap: 40px;
  padding: 10px 20px;
  margin-top: 120px;     /* C√≥ th·ªÉ tƒÉng ƒë·ªÉ tr√°nh header cao 80px */
}


  input[type="file"] {
    display: none;
  }

  
  #customFileLabel:hover {
    background-color: #0056b3;
    box-shadow: 0 6px 12px rgb(0 86 179 / 0.5);
  }

  .row-container {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
  }

  .stt-circle {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: black;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 14px;
    flex-shrink: 0;
  }

  .row-inputs {
    display: grid;
    grid-template-columns: repeat(20, 40px);
    justify-content: center;
    gap: 5px;
  }

  .cell {
    width: 40px;
    height: 40px;
    border: 1px solid #ccc;
    text-align: center;
    font-size: 18px;
    background: white;
    box-sizing: border-box;
  }

  .cell input {
    width: 100%;
    height: 100%;
    border: none;
    text-align: center;
    font-size: 18px;
    text-transform: uppercase;
    background: transparent;
  }

  .vertical-cell {
    background-color: purple;
    color: white;
    font-weight: bold;
  }

  .vertical-highlight {
    background-color: #007BFF !important;
    color: white !important;
    font-weight: bold;
  }

  .row-controls {
    display: flex;
    gap: 5px;
  }

  .row-controls button {
    padding: 6px 10px;
    border: none;
    color: white;
    cursor: pointer;
    border-radius: 4px;
    font-size: 13px;
  }

  .hint {
    background: #2196F3;
  }

  .check {
    background: #4CAF50;
  }

  .reveal {
    background: #f44336;
  }

  #hint-box {
display: none; /* ·∫®n ban ƒë·∫ßu */
    padding: 10px;
    border: 1px solid #ccc;
    background: white;
    min-height: 70px;
    font-size: 16px;
    font-family: 'Times New Roman', serif;
    color: #003366;
    line-height: 1.6;
max-width: 800px;
  width: 100%;
  }
#customFileLabel,
  #verticalAnswerBtn {
    background-color: #007BFF;
    color: white;
    border: none;
    padding: 0 18px;
    height: 45px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 4px 8px rgb(0 123 255 / 0.3);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }

  #verticalAnswerBtn:hover {
    background-color: #0056b3;
    box-shadow: 0 6px 12px rgb(0 86 179 / 0.5);
  }

  #verticalAnswerBtn::before {
    content: "\1F9E9";
    font-size: 18px;
  }

  .left-button label,
  .right-button {
    font-size: 16px;
    padding: 10px 20px;
    height: 45px;
    display: inline-flex;
    align-items: center;
    border-radius: 8px;
    margin-left: var(--dich-phai, 0px);
  }
.top-right-controls {
 position: absolute;
  top: 100px; /* S√°t ngay d∆∞·ªõi header cao 80px */
  z-index: 1000;
  display: flex;
  gap: 10px;
  flex-direction: column;
  align-items: flex-end;
}

header {
  background-color: transparent;
  border-bottom: none;
  box-shadow: none;
  height: 80px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 5px 10px;
  z-index: 1000;
  color: black;
}

.marquee-text {
  color: white;
  font-size: 14px; /* size nh·ªè h∆°n */
  font-weight: normal;
  width: 100%;
  white-space: nowrap;
  margin-bottom: 5px;
}

.title-text {
    font-weight: bold;       /* ch·ªØ ƒë·∫≠m */
    font-size: 36px;         /* c·ª° ch·ªØ l·ªõn, b·∫°n c√≥ th·ªÉ ƒëi·ªÅu ch·ªânh s·ªë px */
    color: red;              /* m√†u ƒë·ªè */
    text-align: center;      /* cƒÉn gi·ªØa */
  }


.vertical-highlight-glow {
  animation: glow 1s ease-in-out infinite alternate;
  box-shadow: 0 0 10px 3px gold;
  border-color: gold !important;
  background-color: #fffae6 !important;
}

@keyframes glow {
  from {
    box-shadow: 0 0 5px 1px gold;
  }
  to {
    box-shadow: 0 0 20px 6px gold;
  }
}

/* Hi·ªáu ·ª©ng vi·ªÅn nh·∫•p nh√°y */
@keyframes borderBlink {
  0%, 100% {
    box-shadow: 0 0 5px 2px rgba(255, 0, 0, 0.7);
    border-color: red;
  }
  50% {
    box-shadow: 0 0 20px 5px rgba(255, 0, 0, 1);
    border-color: yellow;
  }
}
.border-blink {
  animation: borderBlink 1.5s infinite;
}

/* Hi·ªáu ·ª©ng ph√°t s√°ng */
@keyframes glow {
  0%, 100% {
    box-shadow: 0 0 8px 2px rgba(0, 123, 255, 0.7);
  }
  50% {
    box-shadow: 0 0 20px 8px rgba(0, 123, 255, 1);
  }
}
.glow-effect {
  animation: glow 1s infinite alternate;
}

/* Hi·ªáu ·ª©ng nh·∫•p nh√°y n·ªÅn */
@keyframes backgroundBlink {
  0%, 100% {
    background-color: #007BFF;
  }
  50% {
    background-color: #00aaff;
  }
}
.bg-blink {
  animation: backgroundBlink 1s infinite;
}
@keyframes glow-border {
  0% {
    box-shadow: 0 0 5px 2px #ff0000;
  }
  50% {
    box-shadow: 0 0 15px 4px #ffff00;
  }
  100% {
    box-shadow: 0 0 5px 2px #ff0000;
  }
}

.special-cell {
  animation: glow-border 1.5s infinite;
  border: 2px solid gold !important;
  font-weight: bold;
  color: darkred;
}

#clock-container {
  position: fixed;
  top: 30px; /* ƒëi·ªÅu ch·ªânh t√πy thu·ªôc chi·ªÅu cao ph·∫ßn c·ªë ƒë·ªãnh ph√≠a tr√™n */
  left: 10px;
  background-color: rgba(0, 0, 0, 0.7);
  color: #fff;
  padding: 6px 12px;
  border-radius: 8px;
  font-family: monospace;
  font-size: 16px;
  z-index: 9999;
}

 .title-text {
      font-weight: bold;
      font-size: 36px;
      color: yellow;
      text-align: center;
    }
    .top-right-controls {
      position: absolute;
      top: 100px;
      right: 20px;
      display: flex;
      flex-direction: column;
      align-items: center; /* cƒÉn gi·ªØa theo chi·ªÅu ngang c·ªßa c·ªôt */
      gap: 10px;
      z-index: 1000;
    }
    .fixed-clock-box {
      background: #fffacd;
      border: 2px solid #000;
      padding: 10px;
      width: 200px; /* c√πng chi·ªÅu r·ªông v·ªõi n√∫t ƒë√°p √°n */
      text-align: center;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.3);
    }
    .fixed-clock-box .title {
      font-weight: bold;
      font-size: 14px;
      margin-bottom: 5px;
	color: blue;
    }
    .fixed-clock-box .time-input input {
      width: 40px;
      font-size: 16px;
      text-align: center;
    }
    .fixed-clock-box .label {
      font-size: 16px;
      margin-left: 3px;
	color: blue;
	font-weight: bold;
    }
    .fixed-clock-box .countdown {
      background: red;
      color: white;
      font-size: 26px;
      padding: 5px 0;
      border-radius: 10px;
      border: 2px solid #333;
      margin: 6px 0;
    }
    .fixed-clock-box .btn {
      padding: 4px 8px;
      font-size: 13px;
      font-weight: bold;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

 @font-face {
      font-family: 'MyDigitalFont';
      src: url('Donghodemnguoc.ttf') format('truetype');
    }

    .countdown {
      font-family: 'MyDigitalFont', monospace;
      font-size: 48px;
      color: #0F0;
      background: #222;
      padding: 10px 0;
      border-radius: 10px;
      border: 2px solid #0F0;
      text-shadow:
        0 0 5px #0F0,
        0 0 20px #0F0,
        0 0 30px #0F0;
      letter-spacing: 5px;
    }

#bottom-marquee {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: #000000cc; /* n·ªÅn ƒëen m·ªù */
  color: yellow;
  font-size: 18px;
  font-weight: bold;
  padding: 8px 0;
  z-index: 9999;
}
@keyframes blinkIcon {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.3;
    transform: scale(1.2);
  }
}

.blink-success {
  animation: blinkIcon 1s ease-in-out 3;
  color: #00ff00;
}

.blink-fail {
  animation: blinkIcon 1s ease-in-out 3;
  color: #ff4444;
}
.stt-red {
  background-color: red !important;
  color: white !important;
  font-weight: bold;
}

  </style>
<style id="waveDelays"></style>
	
	<link rel="stylesheet" href="menu.css">
</head>
<body>
<div id="clock-container">
  <span id="clock"></span>
</div>


  <header>
  <marquee direction="left" scrollamount="8" class="marquee-text">
    H∆Ø·ªûNG ·ª®NG CHUY·ªÇN ƒê·ªîI S·ªê TRONG NG√ÄNH GI√ÅO D·ª§C - M·ªñI GI√ÅO VI√äN V√Ä M·ªñI NG∆Ø·ªúI L√ÄM TRONG NG√ÄNH GI√ÅO D·ª§C M·ªòT ƒê√ìNG G√ìP, T√åM KI·∫æM V√Ä PH√ÅT HUY C√ÅC C√îNG NGH·ªÜ H·ªñ TR·ª¢ TRONG C√îNG T√ÅC D·∫†Y V√Ä H·ªåC HI·ªÜU QU·∫¢; S·∫¢N PH·∫®M N√ÄY L√Ä C√îNG C·ª§ ·ª®NG D·ª§NG V√ÄO GI·∫¢NG D·∫†Y, ƒê∆Ø·ª¢C VI·∫æT B·ªûI "TH·∫¶Y GI√ÅO MAI THI·ªÜN CH√ÅNH"
  </marquee>

 <div class="title-text">
    TR√í CH∆†I "ƒêI T√åM √î CH·ªÆ B√ç M·∫¨T"
  </div>

<script>
  const text = 'TR√í CH∆†I "ƒêI T√åM √î CH·ªÆ B√ç M·∫¨T"';
  const container = document.getElementById('waveText');
  container.innerHTML = text.split('').map((char) => <span>${char}</span>).join('');
</script>
</header>

<div class="top-right-controls" style="
  position: absolute;
  top: 100px; /* ƒë·∫©y xu·ªëng tr√°nh che n·ªôi dung */
  right: 20px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 10px;
  z-index: 1000;
">
 <label id="customFileLabel" for="fileInput" class="glow-effect">üìÇ M·ªû ƒê·ªÄ T√åM √î CH·ªÆ</label><br>

  <input type="file" id="fileInput" accept=".html" />
  <button id="verticalAnswerBtn" class="glow-effect" onclick="showVerticalAnswer()">ƒê√ÅP √ÅN T·ª™ H.D·ªåC</button> <br>

<!-- Ch√®n kh·ªëi ƒë·ªìng h·ªì ngay b√™n d∆∞·ªõi -->
    <div class="fixed-clock-box">
      <div class="title">TIMES SUY NGHƒ® & TR·∫¢ L·ªúI</div>
      <div class="time-input">
        <input type="number" id="timeInput" min="5" max="600" step="5" value="30">
        <span class="label">GI√ÇY</span>
      </div>
      <div class="countdown" id="countdownDisplay">00 : 00</div>
      
<button class="btn" onclick="startCountdown(() => {
  if (pendingRowToLock) {
    // Ch·ªâ kh√≥a n·∫øu d√≤ng n√†y CH∆ØA ƒë∆∞·ª£c tr·∫£ l·ªùi ƒë√∫ng
    if (!answeredCorrectly[pendingRowToLock.rowIndex]) {
      lockRow(pendingRowToLock.rowInputs);
    }
    pendingRowToLock = null;
  }
})">B·∫ÆT ƒê·∫¶U</button>



      <audio id="alarmSound" src="chuong.mp3" preload="auto"></audio>
    </div>
  </div>


    <div class="container">
    <div class="left-panel">
      <div id="grid"></div>
    </div>
  </div>

  <!-- Ph·∫ßn g·ª£i √Ω ƒë∆∞·ª£c t√°ch ra b√™n ngo√†i container, cƒÉn gi·ªØa -->
  <!-- Ph·∫ßn g·ª£i √Ω ƒë∆∞·ª£c cƒÉn gi·ªØa d∆∞·ªõi l∆∞·ªõi -->
<div style="display: flex; justify-content: center; margin-top: 10px;">
  <div style="display: flex; flex-direction: column; align-items: center; gap: 10px; max-width: 800px; width: 100%;">
    
    <div id="vertical-hint" style="display: none; padding: 10px; background: white; color: #000000; font-size: 18px; border: 2px solid white; border-radius: 12px; font-family: 'Times New Roman', serif; width: 100%; max-height: none; overflow: auto; word-wrap: break-word;">


    </div>

    <div id="hint-box" style="padding: 15px; background: white; border: 1px solid #ccc; border-radius: 12px; font-size: 16px; font-family: 'Times New Roman', serif; color: #003366; line-height: 1.6; max-width: 800px; width: 100%; display: none;">

      <strong>G·ª¢I √ù C√ÇU H·ªéI: </strong><br>L∆Ø·ªöI CH∆†I ƒê√É M·ªû, nh·∫•n ? ·ªü m·ªói h√†ng ngang b·∫•t k·ª≥ ƒë·ªÉ xem g·ª£i √Ω.
    </div>

  </div>
</div>



  <audio id="correctSound" src="correct.mp3" preload="auto"></audio>
  <audio id="wrongSound" src="wrong.mp3" preload="auto"></audio>

  <script>
let data = [];
let answeredCorrectly = []; // m·∫£ng l∆∞u tr·∫°ng th√°i ƒë√∫ng/sai c·ªßa t·ª´ng h√†ng ngang

let verticalExplanation = "";
let verticalDetailedExplanation = "";
const centralColumnIndex = 10;

document.getElementById("fileInput").addEventListener("change", handleFile);

function handleFile(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function (e) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(e.target.result, "text/html");
    const paragraphs = Array.from(doc.body.querySelectorAll("p")).map(p => p.textContent.trim());

    data = [];
    verticalExplanation = "";
    verticalDetailedExplanation = "";
    let currentAnswer = "", currentHint = "", currentVerticalIndex = -1;

let verticalExtraHint = "";
let isVerticalBlock = false;


    paragraphs.forEach(line => {
  if (line.startsWith("- √î h√†ng d·ªçc:")) {
    verticalExplanation = line.split(":")[1].trim();
    isVerticalBlock = true; // ƒë√°nh d·∫•u b·∫Øt ƒë·∫ßu v√πng h√†ng d·ªçc
  } else if (line.startsWith("+ G·ª£i √Ω th√¥ng tin:") && isVerticalBlock) {
    verticalExtraHint = line.split(":")[1].trim();
  } else if (line.startsWith("+ Gi·∫£i th√≠ch t·ª´ h√†ng d·ªçc:")) {
    verticalDetailedExplanation = line.split(":")[1].trim();
  } else if (line.startsWith("- √î h√†ng ngang th·ª©")) {
    isVerticalBlock = false; // ƒë√°nh d·∫•u k·∫øt th√∫c v√πng h√†ng d·ªçc
    if (currentAnswer) {
      data.push({ answer: currentAnswer, hint: currentHint, verticalLetterIndex: currentVerticalIndex });
    }
    currentAnswer = line.split(":")[1].trim().toUpperCase();
    currentHint = "";
    currentVerticalIndex = -1;
  } else if (line.startsWith("+ G·ª£i √Ω th√¥ng tin:")) {
    currentHint = line.split(":")[1].trim();
  } else if (line.startsWith("+ Ch·ªØ c√°i c·∫ßn l·∫•y cho √¥ h√†ng d·ªçc:")) {
    const match = line.match(/√î th·ª© (\d+)/i);
    if (match) currentVerticalIndex = parseInt(match[1]) - 1;
  }
});


    if (currentAnswer) {
  data.push({ answer: currentAnswer, hint: currentHint, verticalLetterIndex: currentVerticalIndex });
}

// ‚úÖ sau khi load xong to√†n b·ªô:
answeredCorrectly = data.map(() => false);

    createGrid();

// Hi·ªÉn th·ªã g·ª£i √Ω c·ªßa t·ª´ h√†ng d·ªçc n·∫øu c√≥
if (verticalExtraHint) {
  const verticalHintBox = document.getElementById("vertical-hint");
  verticalHintBox.innerHTML = `<strong>üìå G·ª£i √Ω cho t·ª´ h√†ng d·ªçc:</strong><br>${verticalExtraHint}`;
  verticalHintBox.style.display = "block";
}


// Hi·ªÉn th·ªã h·ªôp g·ª£i √Ω ch√≠nh
const hintBox = document.getElementById("hint-box");
  hintBox.style.display = "block"; // hi·ªán ra
hintBox.style.fontSize = "20px"; // tƒÉng k√≠ch th∆∞·ªõc ch·ªØ l·ªõn h∆°n
  hintBox.innerHTML = `<strong>VUI M·ª™NG TH√îNG B√ÅO: </strong><br>L∆Ø·ªöI CH∆†I T√åM √î CH·ªÆ B√ç M·∫¨T ƒë√£ m·ªü, H√£y nh·∫•n ‚ç∞  ·ªü m·ªói h√†ng ngang b·∫•t k·ª≥ ƒë·ªÉ xem g·ª£i √Ω.`;
};

  reader.readAsText(file);
}

function createGrid() {
  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  data.forEach((item, rowIndex) => {
    const rowContainer = document.createElement("div");
    rowContainer.className = "row-container";

    // Wrapper STT + icon k·∫øt qu·∫£ b√™n ph·∫£i
    const sttWrapper = document.createElement("div");
    sttWrapper.style.display = "flex";
    sttWrapper.style.flexDirection = "row";
    sttWrapper.style.alignItems = "center";
    sttWrapper.style.justifyContent = "center";
    sttWrapper.style.width = "50px";
    sttWrapper.style.gap = "4px";

    // V√≤ng tr√≤n STT
    const sttCircle = document.createElement("div");
    sttCircle.className = "stt-circle border-blink";
    sttCircle.textContent = rowIndex + 1;

    // Icon b√™n ph·∫£i (‚úîÔ∏è/‚ùå)
    const rightIcon = document.createElement("span");
    rightIcon.className = "right-icon";
    rightIcon.style.fontSize = "14px";
    rightIcon.style.width = "14px";
    rightIcon.style.textAlign = "center";

    // G·∫Øn STT v√† icon v√†o wrapper
    sttWrapper.appendChild(sttCircle);
    sttWrapper.appendChild(rightIcon);

    // Th√™m v√†o d√≤ng
    rowContainer.appendChild(sttWrapper);


    // Ph·∫ßn t·∫°o √¥ ch·ªØ
    const rowInputs = document.createElement("div");
    rowInputs.className = "row-inputs";

    const startCol = centralColumnIndex - item.verticalLetterIndex + 1;

    for (let c = 0; c < item.answer.length; c++) {
      const cell = document.createElement("div");
      cell.className = "cell";
      if (c === item.verticalLetterIndex) cell.classList.add("vertical-cell", "special-cell");
      if (c === 0) cell.style.gridColumnStart = startCol;

      const input = document.createElement("input");
      input.maxLength = 1;

      input.addEventListener("input", function () {
  this.value = this.value.toUpperCase();

  // ƒê·ªïi m√†u ch·ªØ khi nh·∫≠p
  if (c === item.verticalLetterIndex) {
    this.style.color = "white"; // √¥ h√†ng d·ªçc th√¨ ch·ªØ tr·∫Øng
  } else {
    this.style.color = "black"; // c√≤n l·∫°i ch·ªØ ƒëen
  }

  // T·ª± ƒë·ªông chuy·ªÉn sang √¥ ti·∫øp theo
  if (this.value.length === 1) {
    const inputs = rowInputs.querySelectorAll("input");
    const index = Array.from(inputs).indexOf(this);
    if (index < inputs.length - 1) {
      inputs[index + 1].focus();
    }
  }
});

      cell.appendChild(input);
      rowInputs.appendChild(cell);
    }

    rowContainer.appendChild(rowInputs);

    const rowControls = document.createElement("div");
    rowControls.className = "row-controls";

    const hintBtn = document.createElement("button");
    hintBtn.className = "hint";
    hintBtn.textContent = "?";
    hintBtn.onclick = () => {
      const hintBox = document.getElementById("hint-box");
      hintBox.innerHTML =
        `<div style="font-size: 24px; font-weight: nomal; color: #003366;">
          <strong>ƒê·ªô d√†i:</strong> ${item.answer.length} ch·ªØ c√°i<br>
          <strong>G·ª£i √Ω:</strong> ${item.hint}
        </div>`;
      hintBox.scrollIntoView({ behavior: 'smooth' });
// Th√™m m√†u ƒë·ªè cho v√≤ng tr√≤n STT khi nh·∫•n d·∫•u ?
  sttCircle.classList.add("stt-red");
 };

    const checkBtn = document.createElement("button");
    checkBtn.className = "check";
    checkBtn.textContent = "KI·ªÇM TRA";



    checkBtn.onclick = () => {
  const cells = rowInputs.querySelectorAll("input");
  let allCorrect = true;
  cells.forEach((input, i) => {
    input.value = input.value.toUpperCase();
    if (input.value === item.answer[i]) {
      input.parentElement.style.background = "#add8e6";
    } else {
      input.parentElement.style.background = "red";
      input.style.color = "white";
      setTimeout(() => {
        input.value = "";
        input.parentElement.style.background = "";
        input.style.color = "";
      }, 5000);
      allCorrect = false;
    }
  });

  const hintBox = document.getElementById("hint-box");
  const originalHintHTML = 
    `<div style="font-size: 24px; font-weight: normal; color: #003366;">
      <strong>ƒê·ªô d√†i:</strong> ${item.answer.length} ch·ªØ c√°i<br>
      <strong>G·ª£i √Ω:</strong> ${item.hint}
    </div>`;
	    
const rightIconEl = rowContainer.querySelector(".right-icon");

  if (allCorrect) {
  document.getElementById("correctSound").play();
  answeredCorrectly[rowIndex] = true;

  const allAnswered = answeredCorrectly.every(status => status);
  const hintBox = document.getElementById("hint-box");

  if (allAnswered) {
    hintBox.innerHTML = `<div style="font-size: 32px; color: darkgreen; font-weight: bold;">üéØ Tuy·ªát v·ªùi! T·ª´ h√†ng d·ªçc ƒë√£ ƒë∆∞·ª£c t√¨m th·∫•y.</div>`;
  } else {
    hintBox.innerHTML = `<div style="font-size: 32px; color: blue; font-weight: bold;">‚úÖ Ch√≠nh x√°c! üëâ Ch√∫ng ta ch·ªçn h√†ng ngang kh√°c nh√©!</div>`;
  }
  hintBox.style.display = "block";

  // hi·ªáu ·ª©ng glow cho √¥ h√†ng d·ªçc
  const verticalIndex = item.verticalLetterIndex;
  if (verticalIndex >= 0 && verticalIndex < cells.length) {
    const targetCell = cells[verticalIndex].parentElement;
targetCell.classList.add("vertical-highlight-glow"); // ‚úÖ ƒê·∫∑t l·∫°i m√†u ch·ªØ trong √¥ h√†ng d·ªçc th√†nh ƒëen
const verticalInput = targetCell.querySelector("input");
if (verticalInput) verticalInput.style.color = "black"; // ‚úÖ ƒê·∫∑t l·∫°i m√†u ch·ªØ th√†nh ƒëen
  }

  rightIconEl.textContent = "‚úîÔ∏è";
  rightIconEl.classList.remove("blink-fail");
  rightIconEl.classList.add("blink-success");

  checkBtn.disabled = true; // ‚úÖ Kh√≥a n√∫t ki·ªÉm tra sau khi ƒë√∫ng
  lockRow(rowInputs);       // ‚úÖ Kh√≥a input sau khi ƒë√∫ng (gi·ªØ th·ªëng nh·∫•t)

} else {
  document.getElementById("wrongSound").play();
  showHintMessage("Ch∆∞a ƒë√∫ng r·ªìi, b·∫°n ƒë√£ nh·∫ßm chƒÉng?", false, originalHintHTML);

  rightIconEl.textContent = "‚ùå";
  rightIconEl.classList.remove("blink-success");
  rightIconEl.classList.add("blink-fail");

  checkBtn.disabled = true; // ‚úÖ Kh√¥ng cho ki·ªÉm tra l·∫°i
  lockRow(rowInputs);       // ‚úÖ Kho√° c√°c √¥ input c·ªßa d√≤ng ƒë√≥
}
};


    const revealBtn = document.createElement("button");
    revealBtn.className = "reveal";
    revealBtn.textContent = "ƒê√ÅP √ÅN";
    revealBtn.onclick = () => {
  const cells = rowInputs.querySelectorAll("input");

  cells.forEach((input, i) => {
    input.value = item.answer[i];
    input.disabled = true;
    input.style.fontWeight = "bold";
    input.parentElement.style.background = "#add8e6"; // N·ªÅn xanh nh·∫°t
    input.style.color = "black"; // M·∫∑c ƒë·ªãnh ch·ªØ ƒëen
  });

  // X·ª≠ l√Ω ri√™ng cho √¥ h√†ng d·ªçc
  const verticalIndex = item.verticalLetterIndex;
  if (verticalIndex >= 0 && verticalIndex < cells.length) {
    const targetCell = cells[verticalIndex].parentElement;
    const input = targetCell.querySelector("input");

    targetCell.classList.add("vertical-highlight-glow");       // hi·ªáu ·ª©ng s√°ng
	  input.style.color = "black";
    targetCell.style.backgroundColor = "#800080";               // t√≠m ƒë·∫≠m
    input.style.color = "black";                                // ch·ªØ tr·∫Øng n·ªïi b·∫≠t
  }
};

    rowControls.appendChild(hintBtn);
    rowControls.appendChild(checkBtn);
    rowControls.appendChild(revealBtn);
    rowContainer.appendChild(rowControls);

    grid.appendChild(rowContainer);
  });
}

function lockRow(rowInputs) {
  const cells = rowInputs.querySelectorAll("input");
  cells.forEach(input => {
    input.value = "X";
    input.disabled = true;
    input.parentElement.style.background = "#ccc";
    input.style.color = "black";
    input.style.fontWeight = "bold";
  });
}



function showHintMessage(message, isCorrect, originalHintHTML) {
  const hintBox = document.getElementById("hint-box");
  hintBox.innerHTML = 
    `<div style="font-size: 32px; font-weight: bold; text-align: center; color: ${isCorrect ? 'green' : 'red'};">
      ${message}
    </div>
  `;
  hintBox.scrollIntoView({ behavior: 'smooth' });

  const resultColor = isCorrect ? "#4CAF50" : "#f44336";
  const resultIcon = isCorrect ? "‚úÖ" : "‚ùå";

  hintBox.innerHTML = 
    `<div style="
      font-size: 28px;
      font-weight: bold;
      color: ${resultColor};
      margin-bottom: 10px;
    ">${resultIcon} ${message}</div>
    ${originalHintHTML}
  `;

  hintBox.style.display = "block";

  // T·ª± ·∫©n sau 5 gi√¢y
  setTimeout(() => {
  const hintBox = document.getElementById("hint-box");
  // N·∫øu ƒë√£ ƒë√∫ng h·∫øt th√¨ gi·ªØ l·∫°i th√¥ng b√°o h√†ng d·ªçc
  const allAnswered = answeredCorrectly.every(status => status);
  if (!allAnswered) {
    hintBox.innerHTML = originalHintHTML;
    hintBox.style.display = "block";
  }
}, 5000);

}

function showVerticalAnswer() {
  const answers = data.map(item => item.answer[item.verticalLetterIndex] || " ").join("");
  const rows = document.querySelectorAll(".row-inputs");
  rows.forEach((row, i) => {
    const cell = row.children[data[i].verticalLetterIndex];
    if (cell) {
      const input = cell.querySelector("input");
      if (input) input.value = data[i].answer[data[i].verticalLetterIndex];
      cell.classList.remove("vertical-cell");
      cell.classList.add("vertical-highlight");
    }
  });
  document.getElementById("hint-box").innerHTML =
  `<strong>T·ª´ h√†ng d·ªçc:</strong><br>${verticalExplanation}<br><strong>Gi·∫£i th√≠ch:</strong><br>${verticalDetailedExplanation}`;
}
</script>

<div style="display: flex; justify-content: center; margin-top: 30px;">

</div>
<div style="
  position: fixed;
  bottom: 50px;
  right: 20px;
  z-index: 1001;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: flex-end;
">
  <!-- Th√™m n√∫t SO·∫†N C√ÇU H·ªéI l√™n tr√™n 3 n√∫t kh√°c -->
  <button onclick="window.location.href='Soan_o_chu_bi_mat.html'" style="
    background-color: #4caf50;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    width: 220px;
font-weight: bold;
  ">
    ‚úçÔ∏è SO·∫†N √î CH·ªÆ B√ç M·∫¨T
  </button>

  <button class="reset-btn" onclick="window.location.reload()" style="
    background-color: #ff9800;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    width: 220px;
font-weight: bold;
  ">üîÑ RESET</button>

  <button onclick="window.location.href='index.html'" style="
    background-color: red;
    color: white;
    font-weight: bold;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    width: 220px;
  ">
    üè† V·ªÄ TRANG CH·ª¶
  </button>
</div>

<div style="
  position: fixed;
  bottom: 50px;
  left: 20px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: flex-start;
">
  <button id="fullscreen-btn" onclick="toggleFullscreen()" style="
    background-color: #3498db;
    color: white;
    font-weight: bold;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    width: 220px;
    display: block;
transition: background-color 0.3s ease;
  ">
    üì± FULL M√ÄN H√åNH
  </button>
</div>
<script>
/* Toggle fullscreen (d·ª±ng theo English.html) */
function toggleFullscreen() {
    const docElm = document.documentElement;

    // N·∫øu ƒëang fullscreen -> tho√°t
    if (document.fullscreenElement || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement) {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.mozCancelFullScreen) { // Firefox
            document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) { // Chrome, Safari, Opera
            document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) { // IE/Edge
            document.msExitFullscreen();
        }
    } else {
        // V√†o fullscreen
        if (docElm.requestFullscreen) {
            docElm.requestFullscreen();
        } else if (docElm.mozRequestFullScreen) { // Firefox
            docElm.mozRequestFullScreen();
        } else if (docElm.webkitRequestFullscreen) { // Chrome, Safari and Opera
            docElm.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
        } else if (docElm.msRequestFullscreen) { // IE/Edge
            docElm.msRequestFullscreen();
        }
    }
}

/* C·∫≠p nh·∫≠t nh√£n n√∫t khi tr·∫°ng th√°i fullscreen thay ƒë·ªïi (nh·∫•n ESC) */
function updateFullscreenButton() {
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    if (!fullscreenBtn) return;

    const isFullscreen = document.fullscreenElement || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement;

    if (isFullscreen) {
        fullscreenBtn.innerHTML = '‚ùå FULL M√ÄN H√åNH';
        fullscreenBtn.style.backgroundColor = '#e67e22'; // m√†u khi ƒëang fullscreen
    } else {
        fullscreenBtn.innerHTML = 'üì± FULL M√ÄN H√åNH';
        fullscreenBtn.style.backgroundColor = '#3498db'; // m√†u khi ch∆∞a fullscreen
    }
}

/* L·∫Øng nghe s·ª± ki·ªán thay ƒë·ªïi fullscreen (k√®m c√°c ti·ªÅn t·ªë cho tr√¨nh duy·ªát) */
document.addEventListener('fullscreenchange', updateFullscreenButton);
document.addEventListener('webkitfullscreenchange', updateFullscreenButton);
document.addEventListener('mozfullscreenchange', updateFullscreenButton);
document.addEventListener('MSFullscreenChange', updateFullscreenButton);

/* Kh·ªüi t·∫°o tr·∫°ng th√°i n√∫t (n·∫øu trang load m√† ƒëang fullscreen) */
document.addEventListener('DOMContentLoaded', updateFullscreenButton);
</script>
<script>
function lockRow(rowInputs) {
  const inputs = rowInputs.querySelectorAll("input");
  inputs.forEach(input => input.disabled = true);
}

</script>

</script>
<script>
  document.querySelectorAll('input.input-cell').forEach(input => {
    const allowedKeys = ["Backspace", "Delete", "ArrowLeft", "ArrowRight", "Tab", "Enter"];

    input.addEventListener('keydown', function(e) {
      // Cho ph√©p ph√≠m ƒëi·ªÅu h∆∞·ªõng v√† x√≥a
      if (allowedKeys.includes(e.key)) return;

      // Ch·∫∑n k√Ω t·ª± kh√¥ng ph·∫£i A-Z ho·∫∑c a-z
      if (!/^[a-zA-Z]$/.test(e.key)) {
        e.preventDefault();
      }
    });

    input.addEventListener('input', function() {
      this.value = this.value.toUpperCase(); // chuy·ªÉn th√†nh ch·ªØ hoa
    });
  });
</script>

<script>
  function updateClock() {
    const now = new Date();
    const h = String(now.getHours()).padStart(2, '0');
    const m = String(now.getMinutes()).padStart(2, '0');
    const s = String(now.getSeconds()).padStart(2, '0');
    document.getElementById('clock').textContent = `${h}:${m}:${s}`;
  }
  setInterval(updateClock, 1000);
  updateClock();
</script>

<script>
    function formatTime(seconds) {
  const m = Math.floor(seconds / 60);
  const s = seconds % 60;
  const mm = m < 10 ? '0' + m : m;
  const ss = s < 10 ? '0' + s : s;
  return `${mm} : ${ss}`;
}
    let countdownInterval;
let pendingRowToLock = null;
    function startCountdown(callback) {
  let time = parseInt(document.getElementById("timeInput").value);
  const display = document.getElementById("countdownDisplay");
  const alarm = document.getElementById("alarmSound");

  clearInterval(countdownInterval);
  display.textContent = formatTime(time);

  countdownInterval = setInterval(() => {
    time--;
    if (time <= 0) {
      clearInterval(countdownInterval);
      display.textContent = "0 : 00";
      alarm.play();
      if (typeof callback === "function") callback(); // G·ªåI CALLBACK N·∫æU C√ì
      return;
    }
    display.textContent = formatTime(time);
  }, 1000);
}


function openmarquee() {
  const marquee = document.getElementById("bottom-marquee");
  marquee.innerHTML = "üìò H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG GIAO DI·ªÜN: Click M·ªû ƒê·ªÄ T√åM √î CH·ªÆ ƒë·ªÉ l·∫•y ƒë·ªÅ t·ª´ file ƒë·ªÅ ƒë√£ so·∫°n - xu·∫•t - l∆∞u c·ªßa b·∫°n t·ª´ tr∆∞·ªõc. Nh·∫•n v√†o d·∫•u h·ªèi (?) ƒë·ªÉ xem g·ª£i √Ω t·ª´ng h√†ng, sau ƒë√≥ nh·∫≠p t·ª´ tr·∫£ l·ªùi. Nh·∫•n 'KI·ªÇM TRA' ƒë·ªÉ x√°c nh·∫≠n. N·∫øu tr·∫£ l·ªùi ƒë√∫ng h·∫øt, b·∫°n s·∫Ω m·ªü ƒë∆∞·ª£c t·ª´ h√†ng d·ªçc b√≠ m·∫≠t! üöÄ. C√≥ th·ªÉ √°p d·ª•ng th√™m n√∫t B·∫ÆT ƒê·∫¶U ·ªü ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c th·ªùi gian cho ph√©p ng∆∞·ªùi ch∆°i v·ª´a suy nghƒ©, v·ª´a nh·∫≠p k√Ω t·ª± v√† ·∫•n n√∫t KI·ªÇM TRA trong kho·∫£ng th·ªùi gian ƒë√≥. H·∫øt th·ªùi gian, √¥ h√†ng ngang ƒëang t∆∞∆°ng t√°c s·∫Ω b·ªã kh√≥a l·∫°i X. Ch√∫c b·∫°n c√≥ nh·ªØng tr·∫£i nghi·ªám b·ªï √≠ch! (T√°c gi·∫£: Mai Thi·ªán Ch√°nh)";
}

  </script>

<marquee id="bottom-marquee" behavior="scroll" direction="left" scrollamount="6">
  üöÄ C√ôNG CHINH PH·ª§C TR√í CH∆†I "ƒêI T√åM √î CH·ªÆ B√ç M·∫¨T" ‚Äì C√ôNG PH√ÅT HUY T∆Ø DUY V√Ä KH·∫¢ NƒÇNG SUY LU·∫¨N! üéØ 
</marquee>

<!-- N√∫t c·ªë ƒë·ªãnh c√≥ th·ªÉ k√©o -->
<button class="menu-toggle draggable"><img src="TC.png" alt="Menu" class="menu-icon"></button>
<!-- Overlay -->
<div id="overlay" class="overlay"></div>
<!-- Menu -->
<div id="sideMenu" class="side-menu">
<a href="index.html">üè† Trang ch·ªß</a>
  <a href="vong_quay_so.html">üéØ V√≤ng quay s·ªë</a>
  <a href="vong_quay_ten.html">üë• V√≤ng quay t√™n</a>
  <a href="Ai_la_trieu_phu.html">üí∞ Ai l√† tri·ªáu ph√∫</a>
  <a href="O_Chu_bi_mat.html">üß© T√¨m √î ch·ªØ b√≠ m·∫≠t</a>
  <a href="O_Chu_tron_tim.html">üîç Tinh m·∫Øt t√¨m t·ª´</a>
<a href="doan_tu.html">üî§ Game suy ƒëo√°n t·ª´</a>
  <a href="soan_cau_hoi.html">üìù So·∫°n ƒë·ªÅ TN Tick ch·ªçn + ch·∫•m ƒëi·ªÉm</a>
<a href="sukienVN.html">üìñ Theo d√≤ng s·ª± ki·ªán - l·ªãch s·ª≠ VN</a> 
  <a href="fx-570VN%20Plus.html">üìü Gi·∫£ l·∫≠p Fx-570 + B·∫£ng tu·∫ßn ho√†n NTHH</a>
  <a href="Caro.html">üéÆ Game Caro + Music</a>
  <a href="#" onclick="toggleMenu()">‚ùå ƒê√≥ng Menu</a>

</div>

<script src="menu.js"></script>
<script src="chao_name.js"></script>
</body>
</html>
